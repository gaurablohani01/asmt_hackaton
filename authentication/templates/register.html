{% extends 'base.html' %}

{% block title %}Register - ShareTracker{% endblock %}

{% block content %}
<div class="fade-in" style="max-width: 600px; margin: 0 auto;">
    <div class="card">
        <div class="card-header" style="text-align: center;">
            <h1 class="card-title">üöÄ Join Code Bull</h1>
            <p style="color: var(--text-secondary); margin-top: 0.5rem;">
                Create your free account and start tracking your NEPSE portfolio
            </p>
        </div>

        <form method="post" id="registerForm">
            {% csrf_token %}
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                <div class="form-group">
                    <label for="first_name" class="form-label">First Name</label>
                    <input 
                        type="text" 
                        name="first_name" 
                        id="first_name" 
                        class="form-input" 
                        placeholder="John"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="last_name" class="form-label">Last Name</label>
                    <input 
                        type="text" 
                        name="last_name" 
                        id="last_name" 
                        class="form-input" 
                        placeholder="Doe"
                        required
                    >
                </div>
            </div>

            <div class="form-group">
                <label for="username" class="form-label">Username</label>
                <input 
                    type="text" 
                    name="username" 
                    id="username" 
                    class="form-input" 
                    placeholder="Choose a unique username"
                    required
                    minlength="3"
                >
                <small style="color: var(--text-secondary); font-size: 0.8rem;">
                    At least 3 characters, no spaces
                </small>
            </div>

            <div class="form-group">
                <label for="email" class="form-label">Email Address</label>
                <input 
                    type="email" 
                    name="email" 
                    id="email" 
                    class="form-input" 
                    placeholder="your.email@example.com"
                    required
                >
                <small style="color: var(--text-secondary); font-size: 0.8rem;">
                    We'll send a verification link to this email
                </small>
            </div>

            <div class="form-group">
                <label for="password" class="form-label">Password</label>
                <input 
                    type="password" 
                    name="password" 
                    id="password" 
                    class="form-input" 
                    placeholder="Create a strong password"
                    required
                    minlength="6"
                >
                <small style="color: var(--text-secondary); font-size: 0.8rem;">
                    At least 6 characters
                </small>
            </div>

            <div class="form-group">
                <label for="confirm_password" class="form-label">Confirm Password</label>
                <input 
                    type="password" 
                    name="confirm_password" 
                    id="confirm_password" 
                    class="form-input" 
                    placeholder="Repeat your password"
                    required
                >
                <small id="passwordMatch" style="font-size: 0.8rem;"></small>
            </div>

            <!-- TMS Configuration Section -->
            <div style="margin: 2rem 0; padding: 1.5rem; background: var(--bg-primary); border-radius: 0.5rem; border: 1px solid var(--border);">
                <h4 style="margin-bottom: 1rem; color: var(--text-primary); display: flex; align-items: center; gap: 0.5rem;">
                    üè¶ TMS Configuration
                    <small style="font-weight: normal; color: var(--text-secondary); font-size: 0.8rem;">(Optional)</small>
                </h4>
                <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1.5rem;">
                    Configure your TMS server number. You can skip this and configure later in settings.
                </p>

                <div class="form-group">
                    <label for="tms_server_number" class="form-label">TMS Server Number</label>
                    <input 
                        type="number" 
                        name="tms_server_number" 
                        id="tms_server_number" 
                        class="form-input" 
                        placeholder="52"
                        value="52"
                        min="1"
                        max="99"
                    >
                    <small style="color: var(--text-secondary); font-size: 0.8rem;">
                        Enter your broker's TMS server number (e.g., 52, 53, 54...)
                    </small>
                </div>
            </div>

            <div class="form-group">
                <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                    <input type="checkbox" id="terms" required style="width: auto;">
                    <span style="color: var(--text-secondary); font-size: 0.9rem;">
                        I agree to the <a href="#" style="color: var(--accent-primary);">Terms of Service</a> 
                        and <a href="#" style="color: var(--accent-primary);">Privacy Policy</a>
                    </span>
                </label>
            </div>

            <div class="form-group">
                <button type="submit" class="btn btn-primary" style="width: 100%; padding: 0.75rem; font-size: 1rem;">
                    üéâ Create Account
                </button>
            </div>
        </form>

        <div style="text-align: center; margin-top: 2rem; padding-top: 2rem; border-top: 1px solid var(--border);">
            <p style="color: var(--text-secondary);">
                Already have an account? 
                <a href="{% url 'login' %}" style="color: var(--accent-primary); text-decoration: none; font-weight: 500;">
                    Sign in here
                </a>
            </p>
        </div>
    </div>

    <!-- Benefits -->
    <div style="margin-top: 3rem;">
        <h3 style="text-align: center; margin-bottom: 2rem; color: var(--text-primary);">
            Why choose Code Bull?
        </h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
            <div style="text-align: center; padding: 1.5rem; background: var(--bg-card); border-radius: 1rem; border: 1px solid var(--border);">
                <div style="font-size: 2.5rem; margin-bottom: 1rem;">üéØ</div>
                <h4 style="margin-bottom: 0.5rem; color: var(--text-primary);">NEPSE Focused</h4>
                <p style="color: var(--text-secondary); font-size: 0.9rem;">
                    Specifically designed for Nepal Stock Exchange with accurate fee calculations
                </p>
            </div>
            <div style="text-align: center; padding: 1.5rem; background: var(--bg-card); border-radius: 1rem; border: 1px solid var(--border);">
                <div style="font-size: 2.5rem; margin-bottom: 1rem;">üîí</div>
                <h4 style="margin-bottom: 0.5rem; color: var(--text-primary);">100% Free</h4>
                <p style="color: var(--text-secondary); font-size: 0.9rem;">
                    No hidden fees, no premium plans. Everything is completely free forever
                </p>
            </div>
            <div style="text-align: center; padding: 1.5rem; background: var(--bg-card); border-radius: 1rem; border: 1px solid var(--border);">
                <div style="font-size: 2.5rem; margin-bottom: 1rem;">‚ö°</div>
                <h4 style="margin-bottom: 0.5rem; color: var(--text-primary);">Easy to Use</h4>
                <p style="color: var(--text-secondary); font-size: 0.9rem;">
                    Simple interface that anyone can use, from beginners to experts
                </p>
            </div>
        </div>
    </div>
</div>

<script>
    // Real-time password confirmation
    document.getElementById('confirm_password').addEventListener('input', function() {
        const password = document.getElementById('password').value;
        const confirmPassword = this.value;
        const matchIndicator = document.getElementById('passwordMatch');
        
        if (confirmPassword.length > 0) {
            if (password === confirmPassword) {
                matchIndicator.textContent = '‚úì Passwords match';
                matchIndicator.style.color = 'var(--success)';
            } else {
                matchIndicator.textContent = '‚úó Passwords do not match';
                matchIndicator.style.color = 'var(--error)';
            }
        } else {
            matchIndicator.textContent = '';
        }
    });

    // Username validation
    document.getElementById('username').addEventListener('input', function() {
        const username = this.value;
        const hasSpaces = /\s/.test(username);
        
        if (hasSpaces) {
            this.setCustomValidity('Username cannot contain spaces');
        } else {
            this.setCustomValidity('');
        }
    });

    // Form submission validation
    document.getElementById('registerForm').addEventListener('submit', function(e) {
        const password = document.getElementById('password').value;
        const confirmPassword = document.getElementById('confirm_password').value;
        const terms = document.getElementById('terms').checked;
        
        if (password !== confirmPassword) {
            e.preventDefault();
            alert('Passwords do not match!');
            return;
        }
        
        if (!terms) {
            e.preventDefault();
            alert('Please accept the terms and conditions');
            return;
        }
        
        // Show loading state
        const button = this.querySelector('button[type="submit"]');
        button.innerHTML = '<div class="loading"></div> Creating Account...';
        button.disabled = true;
    });

    // Focus on first name field when page loads
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('first_name').focus();
    });
</script>
{% endblock %}
